<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Groq Chat</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{box-sizing:border-box;font-family:Segoe UI,Tahoma,sans-serif}
body{margin:0;background:#eef2ff;display:flex;justify-content:center;align-items:center;height:100vh}
.app{width:900px;height:90vh;background:#fff;border-radius:14px;display:flex;flex-direction:column;overflow:hidden}
header{background:#4f46e5;color:#fff;padding:16px;display:flex;justify-content:space-between}
.controls{padding:12px;border-bottom:1px solid #ddd;display:flex;gap:20px;flex-wrap:wrap}
button{cursor:pointer}
.btn{padding:6px 10px;border-radius:6px;border:1px solid #c7d2fe;background:#eef2ff}
.btn.active{background:#4f46e5;color:#fff}
.messages{flex:1;overflow-y:auto;padding:16px;background:#f9fafb;display:flex;flex-direction:column;gap:12px}
.msg{max-width:85%;padding:10px;border-radius:10px;position:relative;white-space:pre-wrap}
.user{align-self:flex-end;background:#e0e7ff}
.ai{align-self:flex-start;background:#f3f4f6}
.msg-tools{position:absolute;top:6px;right:8px;font-size:.8rem;opacity:.6}
.msg-tools i{margin-left:8px;cursor:pointer}
.input{border-top:1px solid #ddd;padding:12px;display:flex;gap:10px}
textarea{flex:1;resize:none;padding:10px;border-radius:8px;border:1px solid #ccc}
.status{padding:8px 12px;font-size:.85rem;border-top:1px solid #ddd}
.hidden{display:none}
</style>
</head>

<body>
<div class="app">

<header>
  <strong>Groq Chat</strong>
  <input id="apiKey" type="password" placeholder="Groq API key">
</header>

<div class="controls">
  <div>
    <strong>Model</strong><br>
    <button class="btn active model" data-m="llama-3.3-70b-versatile">Maverick</button>
    <button class="btn model" data-m="llama-3.3-8b-instant">Scout</button>
    <button class="btn model" data-m="llama-3.2-90b-vision-preview">Lancer</button>
  </div>

  <div>
    <strong>Personality</strong><br>
    <button class="btn active pers" data-p="helpful">Helpful</button>
    <button class="btn pers" data-p="creative">Creative</button>
    <button class="btn pers" data-p="professional">Professional</button>
    <button class="btn pers" data-p="funny">Funny</button>
    <button class="btn pers" data-p="custom">Custom</button>
  </div>
</div>

<div id="customBox" class="controls hidden">
  <strong>Custom system prompt</strong>
  <textarea id="customPrompt" rows="3"
    placeholder="You are blunt, technical, and never over-explain."></textarea>
</div>

<div class="messages" id="chat"></div>

<div class="input">
  <textarea id="input" placeholder="Message…"></textarea>
  <button class="btn" id="send"><i class="fas fa-paper-plane"></i></button>
</div>

<div class="status" id="status">Ready</div>

</div>

<script>
const chat=document.getElementById('chat');
const input=document.getElementById('input');
const send=document.getElementById('send');
const apiKey=document.getElementById('apiKey');
const status=document.getElementById('status');
const customBox=document.getElementById('customBox');
const customPrompt=document.getElementById('customPrompt');

let model='llama-3.3-70b-versatile';
let systemPrompt='You are a helpful, clear assistant.';
let history=[{role:'system',content:systemPrompt}];

const presets={
  helpful:'You are a helpful, clear assistant.',
  creative:'You are imaginative and expressive.',
  professional:'You are concise and technical.',
  funny:'You are sarcastic but still useful.'
};

function render(){
  chat.innerHTML='';
  history.slice(1).forEach((m, idx)=>{
    const d=document.createElement('div');
    d.className=`msg ${m.role}`;
    d.dataset.idx=idx+1;
    d.innerHTML=`
      <div class="msg-tools">
        <i class="fas fa-pen" title="Edit"></i>
      </div>
      <div class="content">${m.content}</div>`;
    d.querySelector('i').onclick=()=>editMessage(idx+1);
    chat.appendChild(d);
  });
  chat.scrollTop=chat.scrollHeight;
}

function editMessage(historyIndex){
  const msg=history[historyIndex];
  const newText=prompt("Edit message:", msg.content);
  if(newText===null) return;
  history[historyIndex].content=newText;
  render();
}

document.querySelectorAll('.model').forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll('.model').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    model=b.dataset.m;
  };
});

document.querySelectorAll('.pers').forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll('.pers').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');

    if(b.dataset.p==='custom'){
      customBox.classList.remove('hidden');
      systemPrompt=customPrompt.value||'You are a custom assistant.';
    }else{
      customBox.classList.add('hidden');
      systemPrompt=presets[b.dataset.p];
    }
    history[0]={role:'system',content:systemPrompt};
  };
});

customPrompt.oninput=()=>{
  systemPrompt=customPrompt.value;
  history[0]={role:'system',content:systemPrompt};
};

send.onclick=sendMsg;
input.onkeydown=e=>{
  if(e.key==='Enter' && !e.shiftKey){
    e.preventDefault();
    sendMsg();
  }
};

async function sendMsg(){
  const text=input.value.trim();
  if(!text || !apiKey.value.trim()) return;

  customBox.classList.add('hidden');

  history.push({role:'user',content:text});
  render();
  input.value='';
  status.textContent='Thinking…';

  const r=await fetch('https://api.groq.com/openai/v1/chat/completions',{
    method:'POST',
    headers:{
      'Authorization':`Bearer ${apiKey.value}`,
      'Content-Type':'application/json'
    },
    body:JSON.stringify({
      model,
      messages:history,
      max_tokens:1024
    })
  });

  const j=await r.json();
  const reply=j.choices[0].message.content;
  history.push({role:'assistant',content:reply});
  render();
  status.textContent='Ready';
}
</script>
</body>
</html>
